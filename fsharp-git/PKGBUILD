# $Id$
# Contributor: Serkan Hosca <serkan@hosca.com>

pkgname=fsharp-git
pkgver=20121220
pkgrel=3
pkgdesc="An ML based functional language integrated with the .NET platform."
arch=(any)
license=('APACHE')
url="http://www.go-mono.com"
depends=('mono>=2.10.2')
makedepends=('git')
provides=('xsp')
options=(!makeflags)

_gitroot="git://github.com/fsharp/fsharp.git"
_gitname="fsharp"

build() {
  cd "${srcdir}"
  msg 'Connecting to GIT server....'
  if [ -d ${_gitname} ] ; then
    cd ${_gitname} && git checkout -f && git pull origin
  else
    git clone --depth 1 ${_gitroot} ${_gitname}
  fi
  msg 'GIT checkout done or server timeout'
  msg 'Starting make...'

  cd "${srcdir}/${_gitname}"


  # get rid of that .wapi errors; thanks to brice
  export MONO_SHARED_DIR=${srcdir}/src/weird
  mkdir -p "${MONO_SHARED_DIR}"
  # import pathes
  # build
  ./autogen.sh --prefix=/usr
  make || return 1
}

package(){
  cd ${srcdir}/${_gitname}
  make DESTDIR=${pkgdir}/ install || return 1
}
